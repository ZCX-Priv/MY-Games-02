<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‚’è‚¡æ¨¡æ‹Ÿå™¨</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: #333;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #eee;
        }
        h1 {
            color: #2c3e50;
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .stock-info {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .stock-name {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .stock-code {
            font-size: 1.1em;
            opacity: 0.9;
        }
        .main-dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .dashboard-card {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        .card-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            text-align: center;
        }
        .price-display {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255,255,255,0.7);
            border-radius: 6px;
            border-left: 4px solid;
        }
        .price-item.current { border-left-color: #f39c12; }
        .price-item.buy { border-left-color: #3498db; }
        .price-item.sell { border-left-color: #e74c3c; }
        .price-label {
            font-weight: 600;
            font-size: 0.9em;
        }
        .price-value {
            font-weight: bold;
            font-size: 1.1em;
        }
        .change-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
        }
        .change-up {
            color: #e74c3c;
        }
        .change-down {
            color: #27ae60;
        }
        .capital-info {
            text-align: center;
        }
        .capital-value {
            font-size: 2em;
            font-weight: bold;
            color: #27ae60;
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .profit-loss {
            font-size: 1.2em;
            font-weight: bold;
            margin: 10px 0;
        }
        .profit {
            color: #e74c3c;
        }
        .loss {
            color: #27ae60;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        button {
            flex: 1;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        .sell {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        .sell:hover {
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }
        .reset-btn {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            box-shadow: 0 4px 15px rgba(149, 165, 166, 0.3);
        }
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
        }
        .chart-controls {
            display: flex;
            gap: 10px;
        }
        .control-btn {
            padding: 5px 10px;
            font-size: 12px;
            border-radius: 4px;
            background: #ecf0f1;
            color: #2c3e50;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        .control-btn:hover, .control-btn.active {
            background: #3498db;
            color: white;
        }
        canvas {
            width: 100%;
            height: 350px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            background: #fafafa;
        }
        .stats-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .transaction-history {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .history-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }
        .history-list {
            max-height: 200px;
            overflow-y: auto;
        }
        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin-bottom: 5px;
            border-radius: 6px;
            font-size: 0.9em;
        }
        .history-buy {
            background: rgba(52, 152, 219, 0.1);
            border-left: 3px solid #3498db;
        }
        .history-sell {
            background: rgba(231, 76, 60, 0.1);
            border-left: 3px solid #e74c3c;
        }
        .statistics {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .stat-item:last-child {
            border-bottom: none;
        }
        .stat-label {
            font-weight: 600;
            color: #2c3e50;
        }
        .stat-value {
            font-weight: bold;
        }
        @media (max-width: 768px) {
            .main-dashboard {
                grid-template-columns: 1fr;
            }
            .stats-section {
                grid-template-columns: 1fr;
            }
            .action-buttons {
                flex-direction: column;
            }
            h1 {
                font-size: 2em;
            }
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        .notification.show {
            transform: translateX(0);
        }
        .notification.success {
            background: #27ae60;
        }
        .notification.error {
            background: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ç‚’è‚¡æ¨¡æ‹Ÿå™¨ ğŸš€</h1>
            <div class="stock-info">
                <div class="stock-name">è…¾è®¯æ§è‚¡</div>
                <div class="stock-code">HK.00700</div>
            </div>
        </div>
        
        <div class="main-dashboard">
            <div class="dashboard-card">
                <div class="card-title">ğŸ’° èµ„äº§ä¿¡æ¯</div>
                <div class="capital-info">
                    <div class="capital-value">Â¥<span id="value">10000.00</span></div>
                    <div class="profit-loss" id="profitLoss">æ€»ç›ˆäº: Â¥0.00</div>
                    <div class="action-buttons">
                        <button id="buysell" onclick="buyOrSell()">ä¹°å…¥</button>
                        <button class="reset-btn" onclick="resetGame()">é‡ç½®</button>
                    </div>
                </div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-title">ğŸ“Š ä»·æ ¼ä¿¡æ¯</div>
                <div class="price-display">
                    <div class="price-item current">
                        <span class="price-label">å®æ—¶ä»·æ ¼</span>
                        <span class="price-value" id="price">Â¥0.00</span>
                    </div>
                    <div class="price-item buy">
                        <span class="price-label">ä¹°å…¥ä»·æ ¼</span>
                        <span class="price-value" id="buyprice">--</span>
                    </div>
                    <div class="price-item sell">
                        <span class="price-label">å–å‡ºä»·æ ¼</span>
                        <span class="price-value" id="sellprice">--</span>
                    </div>
                </div>
            </div>
            
            <div class="dashboard-card">
                <div class="card-title">ğŸ“ˆ æ¶¨è·Œä¿¡æ¯</div>
                <div class="price-display">
                    <div class="price-item">
                        <span class="price-label">æ¶¨è·Œå¹…</span>
                        <span class="change-indicator" id="changePercent">0.00%</span>
                    </div>
                    <div class="price-item">
                        <span class="price-label">æ¶¨è·Œé¢</span>
                        <span class="change-indicator" id="changeAmount">Â¥0.00</span>
                    </div>
                    <div class="price-item">
                        <span class="price-label">æŒä»“çŠ¶æ€</span>
                        <span class="price-value" id="position">ç©ºä»“</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <div class="chart-title">ğŸ“Š è‚¡ä»·èµ°åŠ¿å›¾</div>
                <div class="chart-controls">
                    <button class="control-btn active" onclick="setSpeed(50)">å¿«é€Ÿ</button>
                    <button class="control-btn" onclick="setSpeed(100)">æ­£å¸¸</button>
                    <button class="control-btn" onclick="setSpeed(200)">æ…¢é€Ÿ</button>
                    <button class="control-btn" onclick="togglePause()">æš‚åœ</button>
                </div>
            </div>
            <canvas id="wiener_process" width="1000" height="350"></canvas>
        </div>
        
        <div class="stats-section">
            <div class="transaction-history">
                <div class="history-title">ğŸ“‹ äº¤æ˜“è®°å½•</div>
                <div class="history-list" id="historyList">
                    <div style="text-align: center; color: #999; padding: 20px;">æš‚æ— äº¤æ˜“è®°å½•</div>
                </div>
            </div>
            
            <div class="statistics">
                <div class="history-title">ğŸ“Š ç»Ÿè®¡ä¿¡æ¯</div>
                <div class="stat-item">
                    <span class="stat-label">äº¤æ˜“æ¬¡æ•°</span>
                    <span class="stat-value" id="tradeCount">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">æˆåŠŸç‡</span>
                    <span class="stat-value" id="successRate">0%</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">æœ€å¤§ç›ˆåˆ©</span>
                    <span class="stat-value" id="maxProfit">Â¥0.00</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">æœ€å¤§äºæŸ</span>
                    <span class="stat-value" id="maxLoss">Â¥0.00</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">å¹³å‡æŒä»“æ—¶é—´</span>
                    <span class="stat-value" id="avgHoldTime">0ç§’</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // æ¸¸æˆçŠ¶æ€å˜é‡
        let gameState = {
            capital: 10000,
            initialCapital: 10000,
            position: 0, // 0: ç©ºä»“, 1: æŒä»“
            buyPrice: 0,
            sellPrice: 0,
            transactions: [],
            stats: {
                tradeCount: 0,
                successfulTrades: 0,
                maxProfit: 0,
                maxLoss: 0,
                totalHoldTime: 0
            },
            holdStartTime: 0,
            isPaused: false,
            lastPrice: 250
        };

        // æ­£æ€åˆ†å¸ƒå‡½æ•°
        function normalDistribution(mean, standardDeviation) {
            let U1 = 1 - Math.random();
            let U2 = 1 - Math.random();
            let R = Math.sqrt(-2 * Math.log(U2));
            let THETA = 2 * Math.PI * U1;
            let Z = R * Math.cos(THETA);
            return mean + (Z * standardDeviation);
        }

        // ç»´çº³è¿‡ç¨‹
        function wienerProcess(x, mean, standardDeviation) {
            return Math.max(1, x + normalDistribution(mean, standardDeviation));
        }

        // ç»˜åˆ¶å›¾è¡¨
        function draw(element, context2d, width, height, arrayDraw) {
            let dx = width / arrayDraw.length;
            let max = Math.max(...arrayDraw);
            let min = Math.min(...arrayDraw);
            let hei = max - min || 1;
            
            // æ¸…ç©ºç”»å¸ƒ
            context2d.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶ç½‘æ ¼çº¿
            context2d.beginPath();
            context2d.strokeStyle = "#ecf0f1";
            context2d.lineWidth = 1;
            for(let i = 0; i <= 10; i++) {
                let y = height * i / 10;
                context2d.moveTo(0, y);
                context2d.lineTo(width, y);
            }
            for(let i = 0; i <= 20; i++) {
                let x = width * i / 20;
                context2d.moveTo(x, 0);
                context2d.lineTo(x, height);
            }
            context2d.stroke();
            
            // ç»˜åˆ¶ä»·æ ¼æ ‡ç­¾
            context2d.fillStyle = "#7f8c8d";
            context2d.font = "12px Arial";
            for(let i = 0; i <= 5; i++) {
                let price = min + (max - min) * (5 - i) / 5;
                let y = height * i / 5;
                context2d.fillText(price.toFixed(1), 5, y + 15);
            }
            
            // ç»˜åˆ¶æ›²çº¿
            context2d.beginPath();
            context2d.strokeStyle = "#3498db";
            context2d.lineWidth = 3;
            for (let i = 0; i < arrayDraw.length; i++) {
                let x = i * dx;
                let y = height * (1 - (arrayDraw[i] - min) / hei);
                if (i === 0) {
                    context2d.moveTo(x, y);
                } else {
                    context2d.lineTo(x, y);
                }
            }
            context2d.stroke();
            
            // å¡«å……æ›²çº¿ä¸‹æ–¹åŒºåŸŸ
            context2d.beginPath();
            context2d.fillStyle = "rgba(52, 152, 219, 0.1)";
            context2d.moveTo(0, height);
            for (let i = 0; i < arrayDraw.length; i++) {
                let x = i * dx;
                let y = height * (1 - (arrayDraw[i] - min) / hei);
                context2d.lineTo(x, y);
            }
            context2d.lineTo(width, height);
            context2d.closePath();
            context2d.fill();
            
            // ç»˜åˆ¶å½“å‰ä»·æ ¼çº¿
            let currentY = height * (1 - (arrayDraw[arrayDraw.length - 1] - min) / hei);
            context2d.beginPath();
            context2d.strokeStyle = "#e74c3c";
            context2d.lineWidth = 2;
            context2d.setLineDash([5, 5]);
            context2d.moveTo(0, currentY);
            context2d.lineTo(width, currentY);
            context2d.stroke();
            context2d.setLineDash([]);
        }

        // æ¸¸æˆå‚æ•°
        let points = 400;
        var delayTime = 100;
        var generate = 1;
        var sequence = [250];
        
        // åˆå§‹åŒ–ä»·æ ¼åºåˆ—
        for (let i = 1; i < points; i++) { 
            sequence[i] = wienerProcess(sequence[i - 1], 0, 2);
        }
        
        // DOMå…ƒç´ 
        var element = document.getElementById("wiener_process");
        var context2d = element.getContext("2d");
        var buyPriceElement = document.getElementById("buyprice");
        var sellPriceElement = document.getElementById("sellprice");
        var priceElement = document.getElementById("price");
        var valueElement = document.getElementById("value");
        var button = document.getElementById("buysell");
        var profitLossElement = document.getElementById("profitLoss");
        var changePercentElement = document.getElementById("changePercent");
        var changeAmountElement = document.getElementById("changeAmount");
        var positionElement = document.getElementById("position");
        
        // æ›´æ–°UI
        function updateUI() {
            let currentPrice = sequence[sequence.length - 1];
            priceElement.innerText = "Â¥" + currentPrice.toFixed(2);
            valueElement.innerText = gameState.capital.toFixed(2);
            
            // è®¡ç®—ç›ˆäº
            let totalProfitLoss = gameState.capital - gameState.initialCapital;
            profitLossElement.innerText = `æ€»ç›ˆäº: Â¥${totalProfitLoss.toFixed(2)}`;
            profitLossElement.className = "profit-loss " + (totalProfitLoss >= 0 ? "profit" : "loss");
            
            // è®¡ç®—æ¶¨è·Œ
            let priceChange = currentPrice - gameState.lastPrice;
            let changePercent = (priceChange / gameState.lastPrice * 100);
            changePercentElement.innerText = (changePercent >= 0 ? "+" : "") + changePercent.toFixed(2) + "%";
            changeAmountElement.innerText = (priceChange >= 0 ? "+Â¥" : "-Â¥") + Math.abs(priceChange).toFixed(2);
            
            changePercentElement.className = "change-indicator " + (priceChange >= 0 ? "change-up" : "change-down");
            changeAmountElement.className = "change-indicator " + (priceChange >= 0 ? "change-up" : "change-down");
            
            // æ›´æ–°æŒä»“çŠ¶æ€
            positionElement.innerText = gameState.position === 0 ? "ç©ºä»“" : "æŒä»“";
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateStats();
        }
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            document.getElementById("tradeCount").innerText = gameState.stats.tradeCount;
            let successRate = gameState.stats.tradeCount > 0 ? 
                (gameState.stats.successfulTrades / gameState.stats.tradeCount * 100).toFixed(1) : 0;
            document.getElementById("successRate").innerText = successRate + "%";
            document.getElementById("maxProfit").innerText = "Â¥" + gameState.stats.maxProfit.toFixed(2);
            document.getElementById("maxLoss").innerText = "Â¥" + gameState.stats.maxLoss.toFixed(2);
            
            let avgHoldTime = gameState.stats.tradeCount > 0 ? 
                (gameState.stats.totalHoldTime / gameState.stats.tradeCount / 1000).toFixed(1) : 0;
            document.getElementById("avgHoldTime").innerText = avgHoldTime + "ç§’";
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'success') {
            let notification = document.getElementById('notification');
            notification.innerText = message;
            notification.className = `notification ${type} show`;
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // æ·»åŠ äº¤æ˜“è®°å½•
        function addTransactionHistory(type, price, profit = null) {
            let time = new Date().toLocaleTimeString();
            let historyList = document.getElementById('historyList');
            
            // æ¸…ç©º"æš‚æ— è®°å½•"æç¤º
            if (gameState.transactions.length === 0) {
                historyList.innerHTML = '';
            }
            
            let historyItem = document.createElement('div');
            historyItem.className = `history-item history-${type}`;
            
            let profitText = profit !== null ? ` (${profit >= 0 ? '+' : ''}Â¥${profit.toFixed(2)})` : '';
            historyItem.innerHTML = `
                <span>${type === 'buy' ? 'ä¹°å…¥' : 'å–å‡º'} Â¥${price.toFixed(2)}${profitText}</span>
                <span>${time}</span>
            `;
            
            historyList.insertBefore(historyItem, historyList.firstChild);
            
            // ä¿æŒæœ€å¤š10æ¡è®°å½•
            while (historyList.children.length > 10) {
                historyList.removeChild(historyList.lastChild);
            }
            
            gameState.transactions.push({type, price, time, profit});
        }
        
        // ä¸»å¾ªç¯
        function delayIncr() {
            if (gameState.isPaused) {
                setTimeout(delayIncr, delayTime);
                return;
            }
            
            let len = sequence.length;
            for (let i = 0; i < generate; i++) {
                let newPrice = wienerProcess(sequence[len - 1], 0, 2);
                sequence.push(newPrice);
                sequence.shift();
            }
            
            draw(element, context2d, element.width, element.height, sequence);
            updateUI();
            gameState.lastPrice = sequence[sequence.length - 1];
            
            setTimeout(delayIncr, delayTime);
        }
        
        // ä¹°å…¥/å–å‡ºåŠŸèƒ½
        function buyOrSell() {
            let currentPrice = sequence[sequence.length - 1];
            
            if (gameState.position === 0) { // ä¹°å…¥
                if (gameState.capital < currentPrice) {
                    showNotification('èµ„é‡‘ä¸è¶³ï¼Œæ— æ³•ä¹°å…¥ï¼', 'error');
                    return;
                }
                
                gameState.position = 1;
                gameState.buyPrice = currentPrice;
                gameState.capital -= currentPrice;
                gameState.holdStartTime = Date.now();
                
                buyPriceElement.innerText = "Â¥" + currentPrice.toFixed(2);
                sellPriceElement.innerText = "--";
                button.innerText = "å–å‡º";
                button.classList.add("sell");
                
                addTransactionHistory('buy', currentPrice);
                showNotification(`æˆåŠŸä¹°å…¥ï¼Œä»·æ ¼ï¼šÂ¥${currentPrice.toFixed(2)}`);
                
            } else { // å–å‡º
                gameState.position = 0;
                gameState.sellPrice = currentPrice;
                gameState.capital += currentPrice;
                
                let profit = currentPrice - gameState.buyPrice;
                let holdTime = Date.now() - gameState.holdStartTime;
                
                // æ›´æ–°ç»Ÿè®¡
                gameState.stats.tradeCount++;
                gameState.stats.totalHoldTime += holdTime;
                
                if (profit > 0) {
                    gameState.stats.successfulTrades++;
                    if (profit > gameState.stats.maxProfit) {
                        gameState.stats.maxProfit = profit;
                    }
                } else {
                    if (Math.abs(profit) > Math.abs(gameState.stats.maxLoss)) {
                        gameState.stats.maxLoss = profit;
                    }
                }
                
                sellPriceElement.innerText = "Â¥" + currentPrice.toFixed(2);
                button.innerText = "ä¹°å…¥";
                button.classList.remove("sell");
                
                addTransactionHistory('sell', currentPrice, profit);
                showNotification(`æˆåŠŸå–å‡ºï¼Œä»·æ ¼ï¼šÂ¥${currentPrice.toFixed(2)}ï¼Œç›ˆäºï¼š${profit >= 0 ? '+' : ''}Â¥${profit.toFixed(2)}`);
            }
        }
        
        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ¸¸æˆå—ï¼Ÿæ‰€æœ‰æ•°æ®å°†è¢«æ¸…ç©ºï¼')) {
                gameState = {
                    capital: 10000,
                    initialCapital: 10000,
                    position: 0,
                    buyPrice: 0,
                    sellPrice: 0,
                    transactions: [],
                    stats: {
                        tradeCount: 0,
                        successfulTrades: 0,
                        maxProfit: 0,
                        maxLoss: 0,
                        totalHoldTime: 0
                    },
                    holdStartTime: 0,
                    isPaused: false,
                    lastPrice: 250
                };
                
                // é‡ç½®ä»·æ ¼åºåˆ—
                sequence = [250];
                for (let i = 1; i < points; i++) { 
                    sequence[i] = wienerProcess(sequence[i - 1], 0, 2);
                }
                
                // é‡ç½®UI
                buyPriceElement.innerText = "--";
                sellPriceElement.innerText = "--";
                button.innerText = "ä¹°å…¥";
                button.classList.remove("sell");
                
                // æ¸…ç©ºäº¤æ˜“è®°å½•
                document.getElementById('historyList').innerHTML = 
                    '<div style="text-align: center; color: #999; padding: 20px;">æš‚æ— äº¤æ˜“è®°å½•</div>';
                
                updateUI();
                showNotification('æ¸¸æˆå·²é‡ç½®ï¼');
            }
        }
        
        // è®¾ç½®é€Ÿåº¦
        function setSpeed(speed) {
            delayTime = speed;
            document.querySelectorAll('.control-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        // æš‚åœ/ç»§ç»­
        function togglePause() {
            gameState.isPaused = !gameState.isPaused;
            event.target.innerText = gameState.isPaused ? 'ç»§ç»­' : 'æš‚åœ';
            showNotification(gameState.isPaused ? 'æ¸¸æˆå·²æš‚åœ' : 'æ¸¸æˆç»§ç»­');
        }
        
        // åˆå§‹åŒ–
        updateUI();
        draw(element, context2d, element.width, element.height, sequence);
        setTimeout(delayIncr, delayTime);
    </script>
</body>
</html>